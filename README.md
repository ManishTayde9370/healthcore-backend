# HealthCore – Django REST API

A Django REST Framework–based API for managing doctors, patients, and their relationships.  
Implements JWT authentication, PostgreSQL persistence, and role-based access to data.

---

## 🚀 Tech Stack
- Django 5
- Django REST Framework
- JWT Authentication (SimpleJWT)
- PostgreSQL
- drf-spectacular (Swagger / API docs)

---

## 📂 Project Setup

### 1. Clone & Install Dependencies
```bash
git clone <your-repo-url>
cd healthcore
pip install -r requirements.txt
```

### 2. Configure Environment Variables
Create a `.env` file in the project root:

```ini
DJANGO_SECRET_KEY=c06f=na9$o&awmsucw3v(m^0pix(p7y5#h98q(oe1658=!p8zy
DJANGO_DEBUG=True
DJANGO_ALLOWED_HOSTS=127.0.0.1,localhost

POSTGRES_DB=healthcore
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_HOST=127.0.0.1
POSTGRES_PORT=5433
```

> ⚠️ Adjust DB credentials if your PostgreSQL is running on a different port or with different credentials.

### 3. Setup Database
Start PostgreSQL, then create the database:
```sql
CREATE DATABASE healthcore;
```

Apply migrations:
```bash
python manage.py migrate
```

### 4. Run Development Server
```bash
python manage.py runserver
```

Server will start at [http://127.0.0.1:8000/](http://127.0.0.1:8000/)

---

## 🔑 API Authentication
This project uses **JWT tokens**.

1. Register → `/api/auth/register/`
2. Login → `/api/auth/login/`  
   Copy the `access` token from response.  
3. For all protected endpoints, add a header:  
   ```
   Authorization: Bearer <ACCESS_TOKEN>
   ```

---

## 📌 API Endpoints

### Authentication
- `POST /api/auth/register/` – create new user  
- `POST /api/auth/login/` – login and get JWT tokens  

### Patients (authenticated user only)
- `POST /api/patients/` – create patient  
- `GET /api/patients/` – list user’s patients  
- `GET /api/patients/<id>/` – retrieve patient  
- `PUT /api/patients/<id>/` – update patient  
- `DELETE /api/patients/<id>/` – delete patient  

### Doctors
- `POST /api/doctors/` – create doctor  
- `GET /api/doctors/` – list all doctors  
- `GET /api/doctors/<id>/` – retrieve doctor  
- `PUT /api/doctors/<id>/` – update doctor  
- `DELETE /api/doctors/<id>/` – delete doctor  

### Patient ↔ Doctor Mappings
- `POST /api/mappings/` – assign doctor to patient  
- `GET /api/mappings/` – list mappings for user’s patients  
- `DELETE /api/mappings/<id>/` – remove mapping  

---

## 🧪 Testing with Postman

1. **Register**
   ```
   POST http://127.0.0.1:8000/api/auth/register/
   Body:
   {
     "username": "manish",
     "email": "mptayde9370@gmail.com",
     "password": "Password@123",
     "first_name": "Manish",
     "last_name": "Tayde"
   }
   ```

2. **Login**
   ```
   POST http://127.0.0.1:8000/api/auth/login/
   Body:
   {
     "username": "manish",
     "password": "Password@123"
   }
   ```
   Copy `access` token from response.

3. **Create Doctor**
   ```
   POST http://127.0.0.1:8000/api/doctors/
   Headers: Authorization: Bearer <ACCESS_TOKEN>
   Body:
   {
     "name": "Dr. Nikhil Rathore",
     "specialization": "Diagnostics",
     "phone": "8523697410",
     "email": "rathorenikhil85@gmail.com"
   }
   ```

4. **Create Patient**
   ```
   POST http://127.0.0.1:8000/api/patients/
   Headers: Authorization: Bearer <ACCESS_TOKEN>
   Body:
   {
     "first_name": "Tejas",
     "last_name": "Patil",
     "age": 20,
     "gender": "M",
     "address": "Dhad, Buldhana"
   }
   ```

5. **Map Patient ↔ Doctor**
   ```
   POST http://127.0.0.1:8000/api/mappings/
   Headers: Authorization: Bearer <ACCESS_TOKEN>
   Body:
   {
     "patient": 1,
     "doctor": 1
   }
   ```

---

## 📊 Database Tables
- `auth_user` – users  
- `clinical_doctor` – doctors  
- `clinical_patient` – patients  
- `clinical_patientdoctor` – patient ↔ doctor mapping  

Verify inside PostgreSQL:
```sql
SELECT * FROM clinical_doctor;
SELECT * FROM clinical_patient;
SELECT * FROM clinical_patientdoctor;
```

---

## 📖 API Docs
Swagger/OpenAPI schema is auto-generated by **drf-spectacular**.  
Visit:
```
http://127.0.0.1:8000/api/docs/
```
