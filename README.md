# Healthcore Backend

A clean and simple **Django REST API** for managing patients, doctors, and their relationships.  
Built with **Django REST Framework**, secured with **JWT authentication**, and powered by **PostgreSQL**.

---

## 🚀 What’s Inside
- Secure user authentication with JWT
- CRUD endpoints for **patients** and **doctors**
- Ability to **map patients to doctors**
- Data stored in PostgreSQL
- Swagger/OpenAPI docs with drf-spectacular

This project was developed as part of a technical assessment, but it follows real-world practices so it can be reused as a starter backend for healthcare or record-management systems.

---

## 🛠️ Setup Guide

### 1. Install dependencies
```bash
pip install -r requirements.txt
```

### 2. Configure environment variables
Create a `.env` file in the project root:

```ini
DJANGO_SECRET_KEY=your-secret-key
DJANGO_DEBUG=True
DJANGO_ALLOWED_HOSTS=127.0.0.1,localhost

POSTGRES_DB=healthcore
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_HOST=127.0.0.1
POSTGRES_PORT=5433
```

### 3. Setup database
Log into PostgreSQL and create the database:
```sql
CREATE DATABASE healthcore;
```

Run migrations:
```bash
python manage.py migrate
```

### 4. Start the server
```bash
python manage.py runserver
```
Server will be available at: [http://127.0.0.1:8000/](http://127.0.0.1:8000/)

---

## 🔑 Authentication
This API uses JWT tokens.

1. Register → `/api/auth/register/`
2. Login → `/api/auth/login/`  
   Copy the `access` token from the response.
3. Add the token to your requests:  
   ```
   Authorization: Bearer <ACCESS_TOKEN>
   ```

---

## 📌 API Endpoints

### Authentication
- `POST /api/auth/register/` – register user  
- `POST /api/auth/login/` – login user and get tokens  

### Patients (user-owned)
- `POST /api/patients/` – create patient  
- `GET /api/patients/` – list patients for current user  
- `GET /api/patients/<id>/` – get single patient  
- `PUT /api/patients/<id>/` – update patient  
- `DELETE /api/patients/<id>/` – delete patient  

### Doctors
- `POST /api/doctors/` – create doctor  
- `GET /api/doctors/` – list all doctors  
- `GET /api/doctors/<id>/` – get single doctor  
- `PUT /api/doctors/<id>/` – update doctor  
- `DELETE /api/doctors/<id>/` – delete doctor  

### Patient ↔ Doctor Mapping
- `POST /api/mappings/` – assign doctor to patient  
- `GET /api/mappings/` – list mappings for current user’s patients  
- `DELETE /api/mappings/<id>/` – remove mapping  

---

## 🧪 Testing with Postman

1. **Register**
   ```
   POST http://127.0.0.1:8000/api/auth/register/
   Body:
   {
     "username": "manish",
     "email": "mptayde9370@gmail.com",
     "password": "Password@123",
     "first_name": "Manish",
     "last_name": "Tayde"
   }
   ```

2. **Login**
   ```
   POST http://127.0.0.1:8000/api/auth/login/
   Body:
   {
     "username": "manish",
     "password": "Password@123"
   }
   ```
   Copy `access` token from response.

3. **Create Doctor**
   ```
   POST http://127.0.0.1:8000/api/doctors/
   Headers: Authorization: Bearer <ACCESS_TOKEN>
   Body:
   {
     "name": "Dr. Nikhil Rathore",
     "specialization": "Diagnostics",
     "phone": "8523697410",
     "email": "rathorenikhil85@gmail.com"
   }
   ```

4. **Create Patient**
   ```
   POST http://127.0.0.1:8000/api/patients/
   Headers: Authorization: Bearer <ACCESS_TOKEN>
   Body:
   {
     "first_name": "Tejas",
     "last_name": "Patil",
     "age": 20,
     "gender": "M",
     "address": "Dhad, Buldhana"
   }
   ```

5. **Map Patient ↔ Doctor**
   ```
   POST http://127.0.0.1:8000/api/mappings/
   Headers: Authorization: Bearer <ACCESS_TOKEN>
   Body:
   {
     "patient": 1,
     "doctor": 1
   }
   ```

---

## 📊 Database Tables
- `auth_user` – users  
- `clinical_doctor` – doctors  
- `clinical_patient` – patients  
- `clinical_patientdoctor` – patient ↔ doctor mapping  

Verify inside PostgreSQL:
```sql
SELECT * FROM clinical_doctor;
SELECT * FROM clinical_patient;
SELECT * FROM clinical_patientdoctor;
```

---

## 📖 API Docs
Swagger/OpenAPI schema is auto-generated by **drf-spectacular**.  
Visit:
```
http://127.0.0.1:8000/api/docs/
```
